<div class="auth-page">
  <div class="container">
    <div class="auth-card">
      <div class="auth-header">
        <h2>Cr√©er un compte</h2>
        <p class="auth-subtitle">Rejoignez VestiSen et commencez √† vendre ou acheter</p>
      </div>
      
      <!-- S√©lection du type de compte -->
      <div class="account-type-selector">
        <button type="button" 
                class="type-btn" 
                [class.active]="accountType === 'CLIENT'"
                (click)="selectAccountType('CLIENT')">
          <span class="type-icon">üë§</span>
          <span class="type-label">Client</span>
          <span class="type-desc">Acheter des articles</span>
        </button>
        <button type="button" 
                class="type-btn" 
                [class.active]="accountType === 'VENDEUR'"
                (click)="selectAccountType('VENDEUR')">
          <span class="type-icon">üè™</span>
          <span class="type-label">Vendeur</span>
          <span class="type-desc">Vendre vos articles</span>
        </button>
      </div>

      <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">
              Pr√©nom <span class="required">*</span>
            </label>
            <input type="text" 
                   class="form-control" 
                   [class.invalid]="isFieldInvalid('firstName')"
                   [class.valid]="isFieldValid('firstName')"
                   formControlName="firstName"
                   placeholder="Votre pr√©nom">
            <span class="error-text" *ngIf="isFieldInvalid('firstName')">
              {{ getFieldError('firstName') }}
            </span>
          </div>
          
          <div class="form-group">
            <label class="form-label">
              Nom <span class="required">*</span>
            </label>
            <input type="text" 
                   class="form-control" 
                   [class.invalid]="isFieldInvalid('lastName')"
                   [class.valid]="isFieldValid('lastName')"
                   formControlName="lastName"
                   placeholder="Votre nom">
            <span class="error-text" *ngIf="isFieldInvalid('lastName')">
              {{ getFieldError('lastName') }}
            </span>
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">
            Email <span class="required">*</span>
          </label>
          <input type="email" 
                 class="form-control" 
                 [class.invalid]="isFieldInvalid('email')"
                 [class.valid]="isFieldValid('email')"
                 formControlName="email"
                 placeholder="exemple@email.com">
          <span class="error-text" *ngIf="isFieldInvalid('email')">
            {{ getFieldError('email') }}
          </span>
        </div>
        
        <!-- Champs sp√©cifiques au vendeur -->
        <div *ngIf="accountType === 'VENDEUR'" class="vendeur-fields">
          <div class="form-group">
            <label class="form-label">
              T√©l√©phone <span class="required">*</span>
            </label>
            <div class="phone-row">
              <select formControlName="phoneCountryCode" 
                      class="form-control phone-country-code"
                      [disabled]="loadingCountries"
                      title="Indicatif pays">
                <option *ngFor="let cc of countryCodes" [value]="cc.dialCode">
                  {{ getFlagEmoji(cc.code) }} {{ cc.dialCode }} {{ cc.name }}
                </option>
              </select>
              <input type="tel" 
                     class="form-control phone-number" 
                     [class.invalid]="isFieldInvalid('phoneNumber')"
                     [class.valid]="isFieldValid('phoneNumber')"
                     formControlName="phoneNumber"
                     placeholder="XX XXX XX XX">
            </div>
            <span class="error-text" *ngIf="isFieldInvalid('phoneNumber')">
              {{ getFieldError('phoneNumber') }}
            </span>
          </div>
          
          <div class="form-group">
            <label class="form-label">
              WhatsApp <span class="required">*</span>
            </label>
            <div class="whatsapp-row">
              <select formControlName="whatsappCountryCode" 
                      class="form-control whatsapp-country-code"
                      [disabled]="loadingCountries"
                      title="Indicatif pays">
                <option *ngFor="let cc of countryCodes" [value]="cc.dialCode">
                  {{ getFlagEmoji(cc.code) }} {{ cc.dialCode }} {{ cc.name }}
                </option>
              </select>
              <input type="tel"
                     class="form-control whatsapp-number"
                     [class.invalid]="isFieldInvalid('whatsappNumber')"
                     [class.valid]="isFieldValid('whatsappNumber')"
                     formControlName="whatsappNumber"
                     placeholder="XX XXX XX XX">
            </div>
            <span class="error-text" *ngIf="isFieldInvalid('whatsappNumber')">
              {{ getFieldError('whatsappNumber') }}
            </span>
          </div>
          
          <div class="form-group">
            <label class="form-label">
              Adresse <span class="required">*</span>
            </label>
            <input type="text" 
                   class="form-control" 
                   [class.invalid]="isFieldInvalid('address')"
                   [class.valid]="isFieldValid('address')"
                   formControlName="address"
                   placeholder="Votre adresse compl√®te">
            <span class="error-text" *ngIf="isFieldInvalid('address')">
              {{ getFieldError('address') }}
            </span>
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">
            Mot de passe <span class="required">*</span>
          </label>
          <input type="password" 
                 class="form-control" 
                 [class.invalid]="isFieldInvalid('password')"
                 [class.valid]="isFieldValid('password')"
                 formControlName="password"
                 placeholder="Minimum 6 caract√®res">
          <span class="error-text" *ngIf="isFieldInvalid('password')">
            {{ getFieldError('password') }}
          </span>
          <span class="help-text" *ngIf="registerForm.get('password')?.value && !isFieldInvalid('password')">
            ‚úì Mot de passe valide
          </span>
        </div>
        
        <div class="form-group">
          <label class="form-label">
            Confirmer le mot de passe <span class="required">*</span>
          </label>
          <input type="password" 
                 class="form-control" 
                 [class.invalid]="isFieldInvalid('confirmPassword') || registerForm.errors?.['passwordMismatch']"
                 [class.valid]="isFieldValid('confirmPassword') && !registerForm.errors?.['passwordMismatch']"
                 formControlName="confirmPassword"
                 placeholder="R√©p√©tez le mot de passe">
          <span class="error-text" *ngIf="isFieldInvalid('confirmPassword') || registerForm.errors?.['passwordMismatch']">
            {{ getFieldError('confirmPassword') }}
          </span>
        </div>
        
        <div class="error-message" *ngIf="error">
          <span class="error-icon">‚ö†Ô∏è</span>
          {{ error }}
        </div>
        
        <button type="submit" 
                class="btn btn-primary btn-block" 
                [disabled]="loading || registerForm.invalid">
          <span *ngIf="!loading">S'inscrire</span>
          <span *ngIf="loading" class="loading-spinner">‚è≥ Inscription en cours...</span>
        </button>
      </form>
      
      <p class="auth-link">
        D√©j√† un compte ? <a routerLink="/login">Connectez-vous</a>
      </p>
    </div>
  </div>
</div>
